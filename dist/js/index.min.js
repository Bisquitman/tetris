!function(){"use strict";var o={d:function(t,e){for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:function(o,t){return Object.prototype.hasOwnProperty.call(o,t)}};function t(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}function e(o,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}function i(o,t,i){return t&&e(o.prototype,t),i&&e(o,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function n(o,t,e){return t in o?Object.defineProperty(o,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[t]=e,o}o.d({},{cn:function(){return h},L0:function(){return v},ng:function(){return u}});var a={J:[[["o","o","o"],["J","J","J"],["o","o","J"]],[["o","J","o"],["o","J","o"],["J","J","o"]],[["J","o","o"],["J","J","J"],["o","o","o"]],[["o","J","J"],["o","J","o"],["o","J","o"]]],I:[[["o","o","o","o"],["I","I","I","I"],["o","o","o","o"],["o","o","o","o"]],[["o","o","I","o"],["o","o","I","o"],["o","o","I","o"],["o","o","I","o"]],[["o","o","o","o"],["o","o","o","o"],["I","I","I","I"],["o","o","o","o"]],[["o","I","o","o"],["o","I","o","o"],["o","I","o","o"],["o","I","o","o"]]],O:[[["O","O"],["O","O"]],[["O","O"],["O","O"]],[["O","O"],["O","O"]],[["O","O"],["O","O"]]],L:[[["o","o","o"],["L","L","L"],["L","o","o"]],[["L","L","o"],["o","L","o"],["o","L","o"]],[["o","o","L"],["L","L","L"],["o","o","o"]],[["o","L","o"],["o","L","o"],["o","L","L"]]],2:[[["o","o","o"],["2","2","o"],["o","2","2"]],[["o","2","o"],["2","2","o"],["2","o","o"]],[["2","2","o"],["o","2","2"],["o","o","o"]],[["o","o","2"],["o","2","2"],["o","2","o"]]],T:[[["o","o","o"],["T","T","T"],["o","T","o"]],[["o","T","o"],["T","T","o"],["o","T","o"]],[["o","T","o"],["T","T","T"],["o","o","o"]],[["o","T","o"],["o","T","T"],["o","T","o"]]],S:[[["o","o","o"],["o","S","S"],["S","S","o"]],[["S","o","o"],["S","S","o"],["o","S","o"]],[["o","S","S"],["S","S","o"],["o","o","o"]],[["o","S","o"],["o","S","S"],["o","o","S"]]]},r=function(){function o(){t(this,o),n(this,"area",[["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"],["o","o","o","o","o","o","o","o","o","o"]]),n(this,"activeTetramino",this.createTetramino()),n(this,"nextTetramino",this.createTetramino())}return i(o,[{key:"createTetramino",value:function(){var o=Object.keys(a),t=o[Math.floor(Math.random()*o.length)],e=a[t],i=Math.floor(Math.random()*e.length);return{block:e[i],rotationIndex:i,rotation:e,x:3,y:0}}},{key:"changeTetramino",value:function(){this.activeTetramino=this.nextTetramino,this.nextTetramino=this.createTetramino()}},{key:"moveLeft",value:function(){this.checkOutPosition(this.activeTetramino.x-1,this.activeTetramino.y)&&(this.activeTetramino.x-=1)}},{key:"moveRight",value:function(){this.checkOutPosition(this.activeTetramino.x+1,this.activeTetramino.y)&&(this.activeTetramino.x+=1)}},{key:"moveDown",value:function(){this.checkOutPosition(this.activeTetramino.x,this.activeTetramino.y+1)?this.activeTetramino.y+=1:this.stopMove()}},{key:"rotateTetramino",value:function(){this.activeTetramino.rotationIndex=this.activeTetramino.rotationIndex<3?this.activeTetramino.rotationIndex+1:0,this.activeTetramino.block=this.activeTetramino.rotation[this.activeTetramino.rotationIndex],this.checkOutPosition(this.activeTetramino.x,this.activeTetramino.y)||(this.activeTetramino.rotationIndex=this.activeTetramino.rotationIndex>0?this.activeTetramino.rotationIndex-1:3,this.activeTetramino.block=this.activeTetramino.rotation[this.activeTetramino.rotationIndex])}},{key:"viewArea",get:function(){for(var o=JSON.parse(JSON.stringify(this.area)),t=this.activeTetramino,e=t.x,i=t.y,n=t.block,a=0;a<n.length;a++)for(var r=n[a],c=0;c<r.length;c++)"o"!==r[c]&&(o[i+a][e+c]=n[a][c]);return o}},{key:"checkOutPosition",value:function(o,t){for(var e=this.activeTetramino.block,i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++)if(!("o"===e[i][n]||this.area[t+i]&&this.area[t+i][o+n]&&"o"===this.area[t+i][o+n]))return!1;return!0}},{key:"stopMove",value:function(){for(var o=this.activeTetramino,t=o.x,e=o.y,i=o.block,n=0;n<i.length;n++)for(var a=i[n],r=0;r<a.length;r++)"o"!==a[r]&&(this.area[e+n][t+r]=i[n][r]);this.changeTetramino(),this.clearRow()}},{key:"clearRow",value:function(){for(var o=this,t=[],e=u-1;e>=0;e--){for(var i=0,n=0;n<v;n++)"o"!==this.area[e][n]&&(i+=1);if(!i)break;i===v&&t.unshift(e)}t.forEach((function(t){o.area.splice(t,1),o.area.unshift(Array(v).fill("o"))}))}}]),o}(),c=function(){function o(e){t(this,o),n(this,"colors",{J:"#14274E",I:"#394867",O:"#9BA4B4",L:"#7A58FF",2:"#396EB0",T:"#DADDFC",S:"#3f484d"}),n(this,"canvas",document.createElement("canvas")),n(this,"context",this.canvas.getContext("2d")),this.container=e,this.preview()}return i(o,[{key:"preview",value:function(){this.container.style.cssText="\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      height: ".concat(h*u,"px;\n      text-align: center;\n      color: #FF376A;\n      font-size: ").concat(10*h,"%;\n      font-family: sans-serif;\n      font-weight: 900;\n    "),this.container.textContent="Press ENTER to start"}},{key:"init",value:function(){this.container.style.cssText="",this.container.textContent="",this.canvas.classList.add("game-area"),this.container.append(this.canvas),this.canvas.width=h*v,this.canvas.height=h*u}},{key:"showArea",value:function(o){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var t=0;t<o.length;t++)for(var e=o[t],i=0;i<e.length;i++){var n=e[i];"o"!==n&&(this.context.fillStyle=this.colors[n],this.context.strokeStyle="white",this.context.fillRect(i*h,t*h,h,h),this.context.strokeRect(i*h,t*h,h,h))}}}]),o}(),s=function(){function o(e,i){t(this,o),this.game=e,this.view=i}return i(o,[{key:"init",value:function(o,t){var e=this;window.addEventListener("keydown",(function(i){i.code!==o&&i.code!==t||(e.view.init(),e.start())}))}},{key:"start",value:function(){var o=this;this.view.showArea(this.game.viewArea),setInterval((function(){o.game.moveDown(),o.view.showArea(o.game.viewArea)}),500),window.addEventListener("keydown",(function(t){switch(t.code){case"ArrowLeft":case"KeyA":o.game.moveLeft(),o.view.showArea(o.game.viewArea);break;case"ArrowRight":case"KeyD":o.game.moveRight(),o.view.showArea(o.game.viewArea);break;case"ArrowDown":case"KeyS":o.game.moveDown(),o.view.showArea(o.game.viewArea);break;case"ArrowUp":case"KeyW":o.game.rotateTetramino(),o.view.showArea(o.game.viewArea)}}))}}]),o}(),h=25,v=10,u=2*v;new s(new r,new c(document.querySelector(".container"))).init("Enter","Space")}();